# 网络科学导论

## 网络基本拓扑性质

* 强连通图： 任何两个节点间均存在一条路径；

* 弱连通图： 将有向连通图中的有向边换成无向边， 若此无向图是连通的， 则原有向图称为弱连通

* 近代网络科学研究中关注最多的3个拓扑性质：平均路径长度、聚类系数、度分布；

### 复杂网络的连通性

#### 无向图中的巨片

#### 有向图中的蝴蝶结构

* 大规模有向网络既不是强连通也不是弱连通， 往往存在一个包含网络中相当部分节点的弱连通片， 称为弱联通巨片， 这一弱连通巨片又往往是一种包含4个组成部分的蝴蝶结结构：
    1. 强连通核

    2. 入部

    3. 出部

    4. 卷须

### 节点的度与网络稀疏性

#### 度与平均度

* 平均度$\langle k \rangle$

>$$ \langle k \rangle = \frac {1} {N} \sum _{i=1} ^{N}k_i$$

#### 网络稀疏性与稠密化

* 网络密度

网络实际边数与最大可能边数之比

>$$ \rho = \frac{M}{\frac{1}{2}N(N -1)}$$

平均度可表示为

>$$\langle k \rangle = \frac{2M}{N} = (N-1)\rho\approx N\rho$$

假设某一时刻网络边数为$\mathcal{M(t)}$, 顶点数为$\mathcal{N(t)}$， 则：
>$$ \mathcal{M(t)} \sim \mathcal{N^\alpha(t)}$$
>$$ 1<\alpha <2$$

### 平均路径长度与直径

* $d_{ij}$表示$i$, $j$之间的路径长度， 网络的平均路径长度表示为($d_{ij}$只计算存在路径的点， 不存在路径，路径长度记为零)：

> $$ L=\frac{1}{N(N-1)}\sum_{i \le j}d_{ij}$$

* 网络直径

> $$ D = max(d_{ij})$$

* 如果网路中距离为$d$的连通节点占整个网络中连通节点数量的比例记为$f(d)$， 网络中距离不超过$d$的连通节点数量占网络中连通节点数量的比例，记为$g(d)$, 对于整数$D$如果满足：
  
>$$ g(D-1) <0.9, g(D) \ge 0.9 $$
称$D$为网络的有效直径

### 聚类系数

#### 无权无向图聚类系数

* 假设节点$i$的度为$k_i$， 即有$k_i$个直接相连的邻居节点， 如果$k_i$个邻居节点两两相连， 存在${k_i}(k_{i} - 1) / 2$条边， 若$k_i$个邻居节点间实际存在$E_i$条边， 则节点$k_i$的聚类系数可表示为:

>$$ C_i = \frac{E_i}{(k_i(k_i - 1)) / 2} = \frac{2E_i}{k_i(k_i - 1)}$$

* 一个网络的聚类系数表示为所有节点的聚类系数的平均值：

>$$ C = \frac{1}{N} \sum_{i=1}^{N}C_i $$

#### 加权网络情形

* 加权网络节点的聚类系数可表示为：

> $$\tilde{C}_i^{(1)} = \frac{1}{k_i(k_i - 1)} \sum _{j,\ k} \omega_{ijk}\alpha_{ij}\alpha_{ik}\alpha_{jk}$$

* $\omega_{ijk}的取值方法$：
  
1. >$$ \omega_{ijk} = \frac{1}{\langle\omega_i \rangle} \frac{\omega_{ij} + \omega_{ik}}{2}$$

其中$\omega_{i}$为节点$i$所有边权值的平均值：
>$$ \langle \omega_i \rangle = \frac{1}{k_i} \sum_j \omega_{ij}$$

### 度分布

* 网络中随机选择一个度为$k$的节点的概率$p_k$称为度分布

### 幂律分布

* 表示形式：

>$$ P(k) \sim k^{-\gamma} $$

* 度不小于$k$的节点在整个网络中所占的比例$P_k$称为累计度分布

> $$ P_k = \sum_{k^{'}=k}^\infty P(k^{'})$$

如果一个网络的度分布满足幂律分布， 则它的累计度分布近似符合指数为$\gamma - 1$的幂分布：

>$$ P_k = C \sum_{k^{'} = k}^{\infty} k^{'-\gamma} \simeq C \int_{k}^{\infty} k^{'-\gamma}dk^{'} = \frac{C}{\gamma - 1}k^{-(\gamma - 1
)} $$

## 度相关性与社团结构

### 联合概率分布

随机选取一条边， 两个端点的度分别是j , k的概率

>$$ P(j, k) = \frac{m(j, k)\mu (j, k)}{2M}$$

$m(j, k)$是度为j的节点和度为k的节点之间存在的边数， 如果$j = k$, 则$\mu(j,k) = 2$, 否则， $\mu(j,k) = 1$

余度分布：表示随机选择一个节点， 再随机选择该节点的一个邻居节点， 该邻居节点的度为$k$的概率

> $$ P_n(k) = \sum_{j=k_{min}}^{k_max}P(j, k) $$

记：

>$$ p_k \stackrel{\triangle}{=} P(k), q_k \stackrel{\triangle}{=} P_n(k), e_{jk} \stackrel{\triangle}{=} P(j, k)  $$

如果网络中两个节点之间是否有边相连与这两个节点的度值无关， 即$e_{jk} = q_jq_k$， 称网络不具有度相关性，或称网络是中性的， 否则称网络具有度相关性。
对与度相关的网络， 如果度大的节点总体上倾向于连接度大的节点， 则称网络是正相关， 或称网络是同配的， 否则称网络是负相关， 或异配的。

### 余平均度

条件概率$P_c(j | k)$定义为网络中度为$k$的节点， 邻居为度为$j$的概率， 与联合概率$P(j, k)$的关系如下：
>$$ P_c(j | k) P_n(k) = P(j, k) $$

如果条件概率$P_c(j | k)$与$k$无关， 说明网络没有度相关性， 度不相关网络的条件概率为
> $$ P_n(k' | k) = P_n(k') = \frac{k'P(k')}{\langle k \rangle} $$

余平均度： 度为$k$的节点的邻居节点的平均度， 称为度为$k$的节点的余平均度， 记为$\langle k_{nn} \rangle(k)$

余平均度、条件概率、联合概率之间的联系如下：

>$$ \langle k_{nn} \rangle (k) = \sum_{k'=k_{min}}^{k_{max}}k'P_c(k' | k) = \frac{1}{q_k}\sum_{k'=k_{min}}^{k_max}k'e_{kk'}$$

### 同配系数

>$$ r = \frac{1}{\sigma_q^2} \sum_{j, k}jk(e_{jk} - q_jq_k) $$
>$$ \sigma_q^2 = \sum_k k^2q_k^2 - [\sum_k kq_k]^2 $$
>$$ r \in [-1, 1] $$
如果r>0说明网络是同配的， 否则说明网络是异配的， r绝对值的大小表示网络同配或异配的程度。

## 社团结构与模块度

### 模块度

对于一个给定的实际网络图， 假定找到了一种社团划分， 那么所有社团内部的边数的总和可计算如下：
>$$ Q_{real} = \frac{1}{2} \sum_{ij} \alpha_{ij} \delta(C_i, C_j)$$
其中$A = (\alpha_{ij})$是实际网络的邻接矩阵， $C_i$$C_j$表示节$i, j$在网络中所在的社团， 如果这两个节点在同一网络$\delta$为1, 否则为0
对于与该实际网络对应的一个零模型， 如果用相同的社团划分， 那么所有社团内部的边数总和的期望值为：
>$$ Q_{null}=\frac{1}{2}\sum_{ij}p_{ij}\delta(C_i, C_j) $$
其中$p_{ij}$是节点$i,j$之间边数的数学期望
模块度定义为:
>$$ Q = \frac{Q_{real} - Q_{null}}{M} $$

模块度的另一种表示方法：

记$e_{vw}$为社团$v$和社团$w$之间的连边占整个网络边数的比例:
>$$ e_{vv} = \frac{1}{2M}\sum_{ij}\alpha_{ij}\delta(C_i, v)\delta(C_j, w) $$

记$\alpha_v$为一端与社团$v$中节点相连的连边的比例：
>$$ \alpha_v = \frac{1}{2M}\sum_i k_i \delta(C_i, v)$$
>$$ Q = \sum_v [e_{vv} - \alpha_v^2] = \sum_{v=1}^{n_c}[\frac{l_v}{M} - (\frac{d_v}{2M})^2]$$
其中$n_c$是社团的数量， $l_v$是社团v内部所包含的边数， $d_v$是社团$v$中所有节点的度值之和

加权有向图的模块度：

>$$ Q_w = \frac{1}{2W} \sum_{ij}(w_{ij} - \frac{s_is_j}{2W}\delta(C_i, C_j) $$
其中$W$表示网络中所有边的权重之和， $w_{ij}$表示$i, j$节点间边的权重，$s_i, s_j$表示节点$i, j$的强度， 即与节点相连的边的权重和， 也可表示为:
>$$ Q_d = \frac{1}{M} \sum_{ij}(\alpha_{ij} - \frac{k_i^{out}k_j^{in}}{M})\delta(C_i, C_j) \\
=\frac{1}{W}\sum_{ij}(w_{ij} - \frac{s_i^{out}s_j^{in}}{W})\delta(C_i, C_j)$$

### 基于模块度的社团检测算法

#### CNM

